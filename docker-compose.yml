services:
  signaling-server:
    image: ghcr.io/pey-k/roommate-signaling:latest
    container_name: roommate-signaling
    hostname: roommate-signaling
    environment:
      - TZ=America/New_York
      - RUST_LOG=info
      - SIGNALING_DB_URL=postgres://roommate:roommate@postgres:5432/roommate
      - SIGNALING_REDIS_URL=redis://redis:6379
    ports:
      - "9001:9001"
    restart: unless-stopped
    healthcheck:
      disable: true
    depends_on:
      - postgres
      - redis

  postgres:
    image: postgres:16
    environment:
      - POSTGRES_USER=roommate
      - POSTGRES_PASSWORD=roommate
      - POSTGRES_DB=roommate
    volumes:
      - signal_pg:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine

volumes:
  signal_pg: {}

networks: {}
